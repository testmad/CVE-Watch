<template>
    <div id="modal-window" @click="$emit('close')">
        
        <div id="id" class='title'>{{ item.cve.CVE_data_meta.ID }}</div>
        <div class='seperator' />
        <div id="desc"><span class='strong'>Description: </span>{{item.cve.description.description_data[0].value}}</div>
        <div class='seperator' />
        <div class='strong item-row-flex-center'>CVSS V2</div>
        <div id='cvss'>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.baseScore}}</div></div>
                    <div class='score-type'>CVSS Base Score</div>
                </div>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.impactScore}}</div></div>
                    <div class='score-type'>Impact Subscore</div>
                </div>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.exploitabilityScore}}</div></div>
                    <div class='score-type'>Exploitability Subscore</div>
                </div>
        </div>
        <div class='strong item-row-flex-center'>Metrics</div>
        <div id='metrics'>
            
            <div class='item-col-flex-outer'>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.accessVector.charAt(0)}}</div></div>
                    <div class='score-type'>Access Vector</div>
                </div>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.accessComplexity.charAt(0)}}</div></div>
                    <div class='score-type'>Access Complexity</div>
                </div>
            </div>
            <div class='item-col-flex-outer'>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.authentication.charAt(0)}}</div></div>
                    <div class='score-type'>Authentication</div>
                </div>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.confidentialityImpact.charAt(0)}}</div></div>
                    <div class='score-type'>Confidentiality</div>
                </div>
            </div>
            <div class='item-col-flex-outer'>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.integrityImpact.charAt(0)}}</div></div>
                    <div class='score-type'>Integrity</div>
                </div>
                <div class='item-row-flex'>
                    <div class='severity'><div class='severity-score'>{{(item.impact.baseMetricV2 == null) ? '?' : item.impact.baseMetricV2.cvssV2.availabilityImpact.charAt(0)}}</div></div>
                    <div class='score-type'>Availability</div>
                </div>
            </div>
        </div>
        <div id="dates">
            <div class="cve-published"><span class='strong'>Published: </span>{{fixDate(item.publishedDate)}}</div>
            <div class="cve-modified"><span class='strong'>Modified: </span>{{fixDate(item.lastModifiedDate)}}</div>
        </div>

    </div>
</template>

<script>
export default {
    name: "modal-cve-info",
    props: {
        item: Object
    },
    methods: {
        fixDate(date) {
            return (new Date(date).toLocaleDateString() + ' ' + new Date(date).toLocaleTimeString())
        }
    },
    created() {
      console.log(this.item)
    }
}
</script>

<style scoped>
#modal-window {
    background: #2c3034;
    
    height: auto;

    color: #6a7179;
    font-weight: 400;
  font-size: 0.95em;
    display: flex;
    flex-direction: column;
    margin: 12px 18px;

}

#cvss {
    display: flex;
    flex-direction: row;
    align-content: center;
    justify-content: center;
    margin: 6px 0px;
}

#metrics {
    display: flex;
    flex-direction: row;
    align-content: center;
    justify-content: center;
    
}

#dates {
    display: flex;
    flex-direction: row;
    align-content: center;
    justify-content: space-between;
    padding: 0px 20px;
    margin-top: 18px;
    margin-bottom: 3px;
}

.item-col-flex-outer {
    display: flex;
    flex-direction: column;
    align-items: left;
    justify-content: center;
    margin-top: 6px;
    
}

.item-row-flex-outer {
    display: flex;
    flex-direction: column;
    align-items: left;
    justify-content: center;
}

.item-row-flex {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin: 6px 6px;
}

.item-row-flex-center {
    display: flex;
    flex-direction: row;
    align-items: center;
    margin-top: 6px;
    justify-content: center;
}

.seperator {
    margin-top: 6px;
    margin-bottom: 6px;
    margin-left: auto;
    margin-right: auto;
    border-top: 1px solid #34383c;
    width: 100%;

    
}

.severity {
  /*background: #34383c;*/
  width: 24px;
  height: 24px;
  border: 1px solid #6a7179;
  display: flex;
  align-items: center;
  justify-content: center;
}

.severity-score {
    font-size: 1em;
    font-weight: 400;
    color: #909ba4;
}

.score-type {
    margin-left: 6px;
}

#desc {
    margin: 6px 0px;
}

.title {
    font-size: 2.0em;
    font-weight: 700;
    color: #04aec8;
    margin-bottom: 4px;
}

.strong {
    font-weight: 700;
    color: #04aec8;
}
</style>

